from os.path import join, basename, abspath
from functools import partial

fn = basename(config['seq'])

def grab_output(wildcards):
    f = []
    for tool in config['tools']:
        p = join(tool, fn + '.gff')
        f.append(p)
    return f

tool_outputs = []
for tool in config['tools']:
    tool_output = join(tool, fn)
    tool_outputs.append(tool_output + '.gff')
    tool_config = config['tools'][tool]
    include: '%s.rule' % tool


rule all:
    input:
        '{seq}.gff'

# rule report:
#     input:
#         '{seq}.gff'
#     output:
#         "{seq}.html"
#     run:
#         from snakemake.utils import report
#         shell('touch {output[0]}')


rule integrate:
    input:
        tool_outputs
    output:
        fn + '.gff'
    shell:
        'touch {output[0]}'


# ruleorder: ncRNA > tRNA > CRISPR
